<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <title>CyberAgent</title>
        <link rel="stylesheet" href="../static/css/style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
        <style>
            #detect-url {
                width: 500px;
            }
        </style>

        <!--header scripts-->
    </head>

    <script>
        async function handleSubmit(event) {
            console.log(event)
          event.preventDefault(); // Prevent the form from reloading the page
    
          // Get the value of the input field
          const inputField = document.getElementById("detect-url");
          const inputValue = inputField.value;
    
          // Create the POST request
          const response = await fetch("/submit", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({ input: inputValue })
          });
    
          // Handle the response
          const result = await response.json();
          console.log("Server response:", result);
          alert("Server response: " + JSON.stringify(result));
        }
      </script>

    <body>
        <!--global-->
        <div id="global">
            <div id="top-bar">
                <a id="top-bar-logo" href="index.html">CyberAgent</a>
                <div id="top-bar-nav">
                    <div id="nav-expand">
                        <i class="fa-solid fa-bars"></i>
                    </div>
                    <a class="top-bar-btn" id="top-bar-home" href="index.html">About</a>
                    <a class="top-bar-btn" id="top-bar-about" href="app.html">App</a>
                </div>
            </div>
        </div>

        <!--main-->
        <div id="main">
            <!--about-->
            <div id="about" class="text-block">
                <h2>About CyberAgent</h2>
                <p>
                    yes
                </p>
            </div>

            <!--detect-->
            <div id="detect" class="text-block">
                <h2>Detect</h2>
                <form onsubmit="handleSubmit(event)">
                    <input id="detect-url" class="text-entry" type="text" placeholder="Enter URL">
                    <button id="detect-btn" class="button" type="submit">Scan for Vulnerabilities</button>
                </form>
            </div>

            <!--detected-->
            <div id="detected" class="text-block">
                <h2>Detected Vulnerabilities</h2>
                <p id="detected-status">
                    Scanning... (x%)
                </p>
                <table>
                    <tr>
                        <th>#</th>
                        <th>Issue</th>
                        <th>File</th>
                        <th>Details</th>
                    </tr>
                    <tr>
                        <td class="td-right">1</td>
                        <td>Insecure Password</td>
                        <td>https://www.site.com/login</td>
                        <td>
                            Password sent as plain text
                            <pre>
insert_code();
                            </pre>
                        </td>
                    </tr>
                    <tr>
                        <td class="td-right">2</td>
                        <td>SQL Injection</td>
                        <td>https://www.site.com/login</td>
                        <td>
                            SQL injection possible
                            <pre>
insert_code();
                            </pre>
                        </td>
                    </tr>
                </table>
            </div>

            <!--footer-->
            <div id="footer">
                <hr>
                <div class="footer-block">
                    <p>
                        <b>CyberAgent</b>
                    </p>
                    <p>
                        <a class="link" target="_blank" href="index.html">
                            About
                        </a><br>
                        <a class="link" target="_blank" href="app.html">
                            App
                        </a>
                    </p>
                </div>
            </div>
        </div>

        <!--scripts-->
        <!-- <script src="../static/src/app.js"></script> -->
    </body>
</html>